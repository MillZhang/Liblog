{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\home\\controller\\index.js"
    ],
    "names": [
        "indexAction",
        "model",
        "findOne",
        "setting",
        "assign",
        "displayView",
        "pageAction",
        "get",
        "aid",
        "id",
        "blogInfo",
        "ispublished",
        "addViewCount",
        "viewcount",
        "tag",
        "tagItem",
        "html",
        "content",
        "strArray",
        "particle",
        "ainfo",
        "pid",
        "indexOf",
        "split",
        "getArticleList",
        "relatearticle",
        "tagname",
        "title",
        "strArrayVal",
        "particleVal",
        "previewAction",
        "newsAction",
        "getList",
        "nodeAction",
        "downloadAction",
        "activityAction",
        "othersAction",
        "jobsAction",
        "itemId",
        "menu",
        "pagenumber",
        "pagesize",
        "getPageSelect",
        "item",
        "itemList",
        "getPageCountSelect",
        "result",
        "Page",
        "think",
        "adapter",
        "page",
        "http",
        "pageData",
        "pagination",
        "itemname",
        "moreAction",
        "categoryAction",
        "category",
        "linkssaveAction",
        "post",
        "mydata",
        "domain",
        "link",
        "qq",
        "addRecord",
        "rs",
        "success",
        "guestsaveAction",
        "nickname",
        "contact",
        "guest",
        "guestAction",
        "aboutAction",
        "adsAction",
        "copyrightAction",
        "linksAction",
        "policyAction",
        "donateAction",
        "dologoutAction",
        "session",
        "redirect",
        "sitemapAction",
        "data",
        "sysdata",
        "findAll",
        "list",
        "article",
        "topic",
        "user",
        "others",
        "url",
        "homeurl",
        "createXml",
        "liblogAction"
    ],
    "mappings": "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",
    "file": "..\\..\\..\\src\\home\\controller\\index.js",
    "sourcesContent": [
        "'use strict';\n\nimport Base from './base.js';\nimport Create from './sitemap.js';\nexport default class extends Base {\n  /**\n   * index action\n   * @return {Promise} []\n   */\n\n  // 首页\n  async indexAction(){\n\n      let setting=await this.model('home').findOne('system_comment');\n      this.assign(\"setting\",setting);\n\n      return this.displayView('index_index');\n  }\n\n  //文章页\n  async pageAction(){\n      let aid= await this.get(\"aid\");\n      let blogInfo=await this.model(\"home\").findOne('article',{id:aid});\n      if(blogInfo.ispublished===1){\n          // 设置浏览量加1\n          let viewcount=await this.model(\"home\").addViewCount({id:aid});\n          //获取标签名\n          let tagItem=await this.model(\"home\").findOne(\"tags\",{id:blogInfo.tag});\n          this.assign('blogInfo',blogInfo);\n          //设置文章分页\n          let html=blogInfo.content;\n          let strArray=[],particle='',ainfo='';\n          let pid=this.get('pid');\n          if(html){\n              if(html.indexOf(\"<!--page-->\")>0){\n                  strArray=html.split(\"<!--page-->\");\n                  if(pid){\n                      let id=pid*1-1;\n                      particle=strArray[id];\n                  }else{\n                      pid=1;\n                      particle=strArray[0];\n                  }\n              }\n          }\n          //关联文章\n          let relatearticle=await this.model(\"home\").getArticleList({tag:blogInfo.tag,ispublished:1})\n          this.assign(\"relatearticle\",relatearticle);\n\n          //跳转到内容分页\n          let tagname=tagItem.tagname||'';\n          let title=blogInfo.title||'';\n          let strArrayVal=strArray||'';\n          let particleVal=particle||'';\n\n          this.assign(\"title\",blogInfo.title);\n          this.assign('strArray',strArrayVal);\n          this.assign('particle',particleVal);\n          this.assign('pid',pid);\n          this.assign('tagname',tagname);\n\n          let setting=await this.model('home').findOne('system_comment');\n          this.assign(\"setting\",setting);\n\n          return this.displayView('index_page');\n      }else{\n          return this.displayView(\"../common/error_404\");\n      }\n    }\n\n    async previewAction(){\n        let aid= await this.get(\"aid\");\n        let blogInfo=await this.model(\"home\").findOne(\"article\",{id:aid});\n        // 设置浏览量加1\n        let viewcount=await this.model(\"home\").addViewCount({id:aid});\n        //获取标签名\n        let tagItem=await this.model(\"home\").findOne(\"tags\",{id:blogInfo.tag});\n        this.assign('blogInfo',blogInfo);\n        //设置文章分页\n        let html=blogInfo.content;\n        let strArray=[],particle='',ainfo='';\n        let pid=this.get('pid');\n        if(html){\n            if(html.indexOf(\"<!--page-->\")>0){\n                strArray=html.split(\"<!--page-->\");\n                if(pid){\n                    let id=pid*1-1;\n                    particle=strArray[id];\n                }else{\n                    pid=1;\n                    particle=strArray[0];\n                }\n            }\n        }\n        //跳转到内容分页\n        let tagname=tagItem.tagname||'';\n        let title=blogInfo.title||'';\n        let strArrayVal=strArray||'';\n        let particleVal=particle||'';\n\n        this.assign(\"title\",blogInfo.title);\n        this.assign('strArray',strArrayVal);\n        this.assign('particle',particleVal);\n        this.assign('pid',pid);\n        this.assign('tagname',tagname);\n        return this.displayView('index_preview');\n    }\n   //前端资讯\n    async newsAction(){\n        this.getList(2,'news');\n    }\n    //nodejs文章\n    async nodeAction(){\n        this.getList(3,'node');\n    }\n    //苹果精品软件\n    async downloadAction(){\n        this.getList(4,'download');\n    }\n    //活动\n    async activityAction(){\n        this.getList(6,'activity');\n    }\n    //大杂烩\n    async othersAction(){\n        this.getList(1,'others');\n    }\n    //招聘\n    async jobsAction(){\n        this.getList(5,'jobs');\n    }\n    //分类公用方法\n    async getList(itemId,menu){\n        let pagenumber=this.get(\"page\")||1;\n        let pagesize=this.get(\"pagesize\")||10;\n        //分页\n        let itemList=await this.model(\"home\").getPageSelect({item:itemId,ispublished:1},pagenumber,pagesize);\n        let result = await this.model(\"home\").getPageCountSelect({item:itemId,ispublished:1},pagenumber,pagesize);\n        var Page=think.adapter(\"template\", \"page\");\n        var page = new Page(this.http);\n        var pageData=page.pagination(result);\n\n        this.assign(\"itemList\",itemList);\n        this.assign('pageData',pageData);\n        this.assign('menu',menu);\n        //分页\n\n        let item=await this.model(\"home\").findOne(\"item\",{id:itemId});\n        this.assign('categoryName',item.itemname);\n        this.assign('more',0);\n        return this.displayView(\"index_item\");\n    }\n    async moreAction(){\n        let pagenumber=this.get(\"page\")||1;\n        let pagesize=this.get(\"pagesize\")||10;\n        //分页\n        let itemList=await this.model(\"home\").getPageSelect({ispublished:1,item:{\"!=\":8}},pagenumber,pagesize);\n        let result = await this.model(\"home\").getPageCountSelect({ispublished:1,item:{\"!=\":8}},pagenumber,pagesize);\n        let Page=think.adapter(\"template\", \"page\");\n        let page = new Page(this.http);\n        let pageData=page.pagination(result);\n\n        this.assign(\"itemList\",itemList);\n        this.assign('pageData',pageData);\n        this.assign('menu','more');\n        //分页\n        this.assign('more',1);\n        this.assign('categoryName','全部文章');\n        return this.displayView(\"index_category\");\n    }\n    //分类\n    async categoryAction(){\n        let pagenumber=this.get(\"page\")||1;\n        let pagesize=this.get(\"pagesize\")||10;\n        let itemId=await this.get(\"id\");\n\n        let itemList=await this.model(\"home\").getPageSelect({tag:itemId,ispublished:1},pagenumber,pagesize);\n        let result = await this.model(\"home\").getPageCountSelect({tag:itemId,ispublished:1},pagenumber,pagesize);\n        let Page=think.adapter(\"template\", \"page\");\n        let page = new Page(this.http);\n        let pageData=page.pagination(result);\n        this.assign(\"itemList\",itemList);\n        this.assign('pageData',pageData);\n        //分页\n        let category=await this.model(\"home\").findOne(\"tags\",{id:itemId});\n        this.assign('categoryName',category.tagname);\n        this.assign('more',0);\n        this.assign('menu','category/'+itemId);\n        return this.displayView('index_category');\n\n    }\n\n    // 友情链接提交接口\n    async linkssaveAction(){\n        let mydata =await this.post();\n        if(mydata.domain!==''&&mydata.link!==''&&mydata.qq!==''){\n          let rs=await this.model(\"home\").addRecord(\"links\",mydata);\n          if(rs) return this.success();\n        }\n    }\n    // 留言提交接口\n    async guestsaveAction(){\n        let mydata =await this.post();\n        if(mydata.nickname!==''&&mydata.contact!==''&&mydata.guest!==''){\n          let rs=await this.model(\"home\").addRecord(\"guest\",mydata);\n          if(rs) return this.success();\n        }\n    }\n    async guestAction(){\n        this.assign(\"title\",\"留言板\");\n        return this.displayView(\"index_guest\");\n    }\n    async aboutAction(){\n        this.assign(\"title\",\"关于我们\");\n        return this.displayView(\"index_about\");\n    }\n    async adsAction(){\n        this.assign(\"title\",\"推广服务\");\n        return this.displayView(\"index_ads\");\n    }\n    async copyrightAction(){\n        this.assign(\"title\",\"版权声明\");\n        return this.displayView(\"index_copyright\");\n    }\n    async linksAction(){\n        this.assign(\"title\",\"友情链接\");\n        return this.displayView(\"index_links\");\n    }\n    async policyAction(){\n        this.assign(\"title\",\"注册协议\");\n        return this.displayView(\"index_policy\");\n    }\n    async donateAction(){\n        this.assign(\"title\",\"捐赠\");\n        return this.displayView(\"index_donate\");\n    }\n    async dologoutAction(){\n             this.session(\"uInfo\",\"\");\n      return this.redirect(\"/login.html\");\n    }\n\n    // 站点地图\n    async sitemapAction() {\n\n          //生成xml\n          let data={};\n          let sysdata=await this.model(\"home\").findOne(\"system\",{id:1});\n          //获取分类页list\n          let list=await this.model(\"home\").findAll(\"item\");\n          //获取文章列表article\n          let article=await this.model(\"home\").findAll(\"article\");\n          //获取主题帖\n          let topic=await this.model(\"home\").findAll(\"topic\");\n          //获取个人主页\n          let user=await this.model(\"home\").findAll(\"user\");\n          let others=[\n                          { id: 1, itemname: '大杂烩',url:'others.html' },\n                          { id: 2, itemname: '前端资讯',url:'news.html' },\n                          { id: 3, itemname: 'nodejs',url:'node.html' },\n                          { id: 4, itemname: '资源下载',url:'download.html' },\n                          { id: 5, itemname: '招聘',url:'jobs.html' },\n                          { id: 6, itemname: '活动',url:'activity.html' },\n                          { id: 7, itemname: '关于',url:'about.html' },\n                          { id: 8, itemname: '友情链接',url:'links.html' },\n                          { id: 9, itemname: '注册',url:'register.html' },\n                          { id: 10, itemname: '捐赠',url:'donate.html' },\n                          { id: 11, itemname: '推广服务',url:'ads.html' },\n                          { id: 12, itemname: '注册协议',url:'policy.html' },\n                          { id: 13, itemname: '版权声明',url:'copyright.html' },\n                          { id: 14, itemname: '会员登录',url:'login.html' },\n                          { id: 15, itemname: '留言板',url:'guest.html' },\n                          { id: 16, itemname: 'liblog',url:'liblog.html' }\n                     ];\n          data={\n              homeurl:sysdata.url,\n              list:list,\n              article:article,\n              others:others,\n              topic:topic,\n              user:user\n          }\n          Create.createXml(data);\n          return this.displayView(\"index_sitemap\");\n\n    }\n\n    async liblogAction(){\n      return this.displayView(\"index_liblog\");\n    }\n}\n"
    ]
}